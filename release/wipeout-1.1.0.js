// WipeoutJs v1.0.0
// (c) Shane Connon 2014
// http://www.opensource.org/licenses/mit-license.php
(function(){var m={};var b=function(n){var o=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP");o.onreadystatechange=function(){if(o.readyState==XMLHttpRequest.DONE){if((o.status==200||o.status==0)&&n.success){n.success(o)}else{if(n.error){n.error(o)}}}};o.open(n.type||"GET",n.url||document.location.href,n.async!==undefined?n.async:true);o.send();return o};var g=function(p,n,o){if(!p){return}o=o||window;for(var q=0,r=p.length;q<r;q++){n.call(o,p[q],q)}};var h=function(p,n,o){if(!p){return}o=o||window;if(p==null){return}for(var q in p){n.call(o,p[q],q)}};var c=function(p,o,n){var q=e("wipeout.bindings."+p,n);ko.bindingHandlers[p]={init:q.init,update:q.update};if(o){ko.virtualElements.allowedBindings[p]=true}};var e=function(o,n){o=o.split(".");var p=o.splice(0,o.length-1);var q={};q[o[o.length-1]]=n();i(p.join("."),q);return q[o[o.length-1]]};var i=function(p,o){p=p.split(".");if(p[0]!=="wipeout"){throw'Root must be "wipeout".'}p.splice(0,1);var n=m;g(p,function(q){n=n[q]||(n[q]={})});if(o&&o instanceof Function){o=o()}h(o,function(r,q){n[q]=r})};var a=/^\s+|\s+$/g;var k=function(n){return n?n.replace(a,""):n};var l=function(n){return n?k(n).toLowerCase():n};var j=function(n){if(n==null){return false}n=l(n);return !!(n&&n!=="false"&&n!=="0")};var d=function(o){if(!o){return o}var p=/\-/,n;while((n=o.search(p))!==-1){if(n===o.length-1){return o.substr(0,n)}else{o=o.substr(0,n)+o[n+1].toUpperCase()+o.substr(n+2)}}return o};e("wipeout.utils.obj",function(){var q=function(u,v){if(!v){v=window}var t=u.split(".");for(var w=0,x=t.length;w<x;w++){v=v[t[w]];if(v==null){return null}}return v};var o=function(u,v){var t=q(u,v);if(t instanceof Function){var w=new t();if(w instanceof m.base.view&&f){w.__woBag.constructedViewType=u}return w}throw u+" is not a valid function."};var n=function(v){var w=[];for(var t=0,u=v.length;t<u;t++){w.push(v[t])}return w};var p=function(u,t){return u.indexOf(t,u.length-t.length)!==-1};var s=function(t){return Math.floor(Math.random()*t)};var r=function r(){};r.camelCase=d;r.ajax=b;r.parseBool=j;r.trimToLower=l;r.trim=k;r.enumerateArr=g;r.enumerateObj=h;r.getObject=q;r.createObject=o;r.copyArray=n;r.random=s;r.endsWith=p;return r});e("wipeout.base.object",function(){var o=function o(){};var n={parents:[],children:[]};o.clearVirtualCache=function(q){if(!q){n.parents.length=0;n.children.length=0;return}for(var r=0,s=n.children.length;r<s;r++){if(n.children[r]===q||n.parents[r]===q){n.children.splice(r,1);n.parents.splice(r,1)}}};o.useVirtualCache=true;o.prototype._super=function(){var s=arguments.callee.caller;var q=null;if(o.useVirtualCache){var y=n.children.indexOf(s);if(y!==-1){q=n.parents[y]}}if(!q){var v=[];var r=this.constructor.prototype;while(r){v.push(r);r=Object.getPrototypeOf(r)}v.reverse();for(var t=0,u=v.length;t<u;t++){if(v[t]===s.prototype){q=v[t-1].constructor}else{for(var x in v[t]){if(v[t][x]===s){for(var w=t-1;w>=0;w--){if(v[w][x]!==s){q=v[w][x];break}}}if(q){break}}}if(q){if(o.useVirtualCache){n.children.push(s);n.parents.push(q)}break}}if(!q){throw"Could not find method in parent class"}}return q.apply(this,arguments)};var p=/^[a-zA-Z_][a-zA-Z_0-9]*$/;o.extend=function(r){if(r.constructor===Function){var q=r;r={constructor:q,statics:{}};for(var t in r.constructor){r.statics[s]=r.constructor[s]}for(var t in r.constructor.prototype){r[s]=r.constructor.prototype[s]}}else{if(r.constructor===Object){r.constructor=function(){this._super.apply(this,arguments)}}else{if(!r.constructor||r.constructor.constructor!==Function){throw'the property "constructor" must be a function'}}}for(var v in this){if(this.hasOwnProperty(v)&&this[v]&&this[v].constructor===Function&&this[v]!==o.clearVirtualCache&&r.constructor[v]===undefined){r.constructor[v]=this[v]}}var w=function(){this.constructor=r.constructor};w.prototype=this.prototype;r.constructor.prototype=new w();for(var s in r){if(s==="constructor"){continue}if(s==="statics"){for(var u in r[s]){r.constructor[u]=r[s][u]}continue}r.constructor.prototype[s]=r[s]}return r.constructor};return o});e("wipeout.utils.domManipulationWorkerBase",function(){var n=m.base.object.extend(function n(){this._super();this._mutations=[]});n.prototype.finish=function(){for(var o=0;o<this._mutations.length;o++){if(!document.body.contains(this._mutations[o])){m.utils.html.cleanNode(this._mutations.splice(o,1)[0]);o--}}g(this._mutations,function(p){g(m.bindings.bindingBase.getBindings(p,m.bindings.render),function(q){q.hasMoved()})});this._mutations.length=0};return n});e("wipeout.base.disposable",function(){var n=m.base.object.extend(function n(o){this._super();this.disposeFunction=o||function(){}});n.prototype.dispose=function(){if(this.disposeFunction){this.disposeFunction()}delete this.disposeFunction};return n});e("wipeout.base.visual",function(){var o=m.base.object.extend(function o(p){this._super();this.shareParentScope=false;this.templateItems={};this.templateId=ko.observable(p||o.getDefaultTemplateId());this.__woBag={disposed:m.base.event(),disposables:{},createdByWipeout:false,rootHtmlElement:null,routedEventSubscriptions:[],nodes:[]}});o.getDefaultTemplateId=(function(){var p=null;return function(){if(!p){p=m.base.contentControl.createAnonymousTemplate("<span>No template has been specified</span>")}return p}})();o.getBlankTemplateId=(function(){var p=null;return function(){if(!p){p=m.base.contentControl.createAnonymousTemplate("")}return p}})();o.visualGraph=function(r,p){if(!r){return[]}p=p||function(){return typeof arguments[0]};var q=[];m.utils.obj.enumerateArr(m.utils.html.getAllChildren(r),function(t){m.utils.obj.enumerateArr(o.visualGraph(t),q.push,q)});var s=m.utils.domData.get(r,m.bindings.wipeout.utils.wipeoutKey);if(s){return[{viewModel:s,display:p(s),children:q}]}return q};o.prototype.entireViewModelHtml=function(){if(this.__woBag.rootHtmlElement){if(this.__woBag.rootHtmlElement.nodeType===1){return[this.__woBag.rootHtmlElement]}else{if(m.utils.ko.isVirtual(this.__woBag.rootHtmlElement)){var q=[this.__woBag.rootHtmlElement];m.utils.ko.enumerateOverChildren(this.__woBag.rootHtmlElement,function(r){q.push(r);if(m.utils.ko.isVirtual(r)){q.push(m.utils.ko.getClosingTag(r))}});var p=q[q.length-1].nextSibling;if(!m.utils.ko.isVirtualClosing(p)){throw"Could not compile view model html"}q.push(p);return q}}}return[]};o.prototype.disposeOf=function(p){if(this.__woBag.disposables[p]){this.__woBag.disposables[p]();delete this.__woBag.disposables[p]}};o.prototype.disposeOfAll=function(){for(var p in this.__woBag.disposables){this.disposeOf(p)}};o.prototype.registerDisposeCallback=(function(){var p=0;return function(q){if(!q||q.constructor!==Function){throw"The dispose function must be a Function"}var r=(++p).toString();this.__woBag.disposables[r]=q;return r}})();o.prototype.registerDisposable=function(p){if(!p){throw"Invalid disposeable object"}if(p.constructor===Function&&!p.dispose){p=p.call(this)}if(!p||!(p.dispose instanceof Function)){throw"The disposable object must have a dispose(...) function"}return this.registerDisposeCallback(function(){p.dispose()})};o.prototype.getRootHtmlElement=function(){return this.__woBag.rootHtmlElement};o.prototype.dispose=function(){for(var p in this){if(ko.isObservable(this[p])&&this[p].dispose instanceof Function){this[p].dispose()}}g(this.__woBag.routedEventSubscriptions.splice(0,this.__woBag.routedEventSubscriptions.length),function(q){q.dispose()});this.__woBag.disposed.trigger()};o.prototype.getParents=function(q){var p=this.getParent(q);var r=[];while(p){r.push(p);p=p.getParent(q)}return r};o.prototype.getParent=function(p){var r;var q=!this.__woBag.rootHtmlElement||!(r=m.utils.ko.parentElement(this.__woBag.rootHtmlElement))?null:m.utils.html.getViewModel(r);return p||!q||!q.shareParentScope?q:q.getParent(p)};o.prototype.unRegisterRoutedEvent=function(t,p,q){for(var r=0,s=this.__woBag.routedEventSubscriptions.length;r<s;r++){if(this.__woBag.routedEventSubscriptions[r].routedEvent===t){this.__woBag.routedEventSubscriptions[r].event.unRegister(p,q);return true}}return false};o.prototype.registerRoutedEvent=function(v,p,q,t){var u;for(var r=0,s=this.__woBag.routedEventSubscriptions.length;r<s;r++){if(this.__woBag.routedEventSubscriptions[r].routedEvent===v){u=this.__woBag.routedEventSubscriptions[r];break}}if(!u){u=new m.base.routedEventRegistration(v);this.__woBag.routedEventSubscriptions.push(u)}return u.event.register(p,q,t)};o.prototype.triggerRoutedEvent=function(t,p){if(!(p instanceof m.base.routedEventArgs)){p=new m.base.routedEventArgs(p,this)}for(var q=0,r=this.__woBag.routedEventSubscriptions.length;q<r;q++){if(p.handled){return}if(this.__woBag.routedEventSubscriptions[q].routedEvent===t){this.__woBag.routedEventSubscriptions[q].event.trigger(p)}}if(p.handled){return}if(this.model() instanceof m.base.routedEventModel){this.model().routedEventTriggered(t,p)}if(p.handled){return}var s=this.getParent();if(s){s.triggerRoutedEvent(t,p)}};o.prototype.onRendered=function(q,p){};o.prototype.onUnrendered=function(){};o.prototype.onApplicationInitialized=function(){};var n=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","command","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","head","header","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","map","mark","menu","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"];o.reservedTags={};g(n,function(p){o.reservedTags[p]=true});return o});e("wipeout.base.view",function(){var n="wipeout.base.view.modelRoutedEvents";var o=m.base.visual.extend(function o(r,q){this._super(r);if(q===undefined){q=null}this.model=ko.observable(q);var p=this.model.subscribe(function(s){try{this._onModelChanged(q,s)}finally{q=s}},this);this.registerDisposable(p);this.__woBag.bindings={}});o.setObservable=function(p,q,r){if(ko.isObservable(p[q])){p[q](ko.utils.unwrapObservable(r))}else{p[q]=ko.utils.unwrapObservable(r)}};o.prototype.disposeOfBinding=function(p){if(this.__woBag.bindings[p]){this.__woBag.bindings[p].dispose()}};o.prototype.dispose=function(){this._super();if(this.__woBag[n]){this.disposeOf(this.__woBag[n]);delete this.__woBag[n]}for(var p in this.__woBag.bindings){this.disposeOfBinding(p)}};o.prototype.onInitialized=function(){};o.prototype.bind=function(q,x,u){if(u&&(!ko.isObservable(this[q])||!ko.isObservable(x()))){throw"Two way bindings must be between 2 observables"}this.disposeOfBinding(q);var t=ko.dependentObservable({read:function(){return ko.utils.unwrapObservable(x())},write:u?function(){var y=x();if(y){y(arguments[0])}}:undefined});var v=false;var w=false;o.setObservable(this,q,t.peek());var r=t.subscribe(function(y){if(!v){try{w=true;o.setObservable(this,q,y)}finally{w=false}}},this);var s=u?this[q].subscribe(function(y){if(!w){try{v=true;o.setObservable({x:t},"x",y)}finally{v=false}}},this):null;var p=this;return this.__woBag.bindings[q]=new m.base.disposable(function(){if(r){r.dispose();r=null}if(s){s.dispose();s=null}if(t){t.dispose();t=null}delete p.__woBag.bindings[q]})};o._elementHasModelBinding=function(p){for(var q=0,r=p.attributes.length;q<r;q++){if(p.attributes[q].nodeName==="model"||p.attributes[q].nodeName==="model-tw"){return true}}for(var q=0,r=p.childNodes.length;q<r;q++){if(p.childNodes[q].nodeType===1&&p.childNodes[q].nodeName==="model"){return true}}return false};o.reservedPropertyNames=["constructor","id"];o.prototype._initialize=function(s,q){if(this.__woBag.initialized){throw"Cannot call initialize item twice"}this.__woBag.initialized=true;if(!s){return}var r=s.getAttribute("id");if(r){this.id=r}r=s.getAttribute("shareParentScope")||s.getAttribute("share-parent-scope");if(r){this.shareParentScope=j(r)}if(!o._elementHasModelBinding(s)&&m.utils.ko.peek(this.model)==null){this.bind("model",q.$data.model)}var p=this.shareParentScope?q:q.createChildContext(this);g(s.attributes,function(t){var u=t.nodeName,v="";if(t.nodeName.length>3&&u.substr(u.length-3)==="-tw"){u=u.substr(0,u.length-3);v=",\n\t\t\tfunction(val) {\n\t\t\t\tif(!ko.isObservable("+t.value+"))\n\t\t\t\t\tthrow 'Two way bindings must be between 2 observables';\n\t\t\t\t"+t.value+"(val);\n\t\t\t}"}u=d(u);if(o.reservedPropertyNames.indexOf(u)!==-1){return}try{p.__$woCurrent=this;m.template.engine.createJavaScriptEvaluatorFunction("(function() {\n\t\t\t__$woCurrent.bind('"+u+"', function() {\n\t\t\t\treturn "+t.value+";\n\t\t\t}"+v+");\n\n\t\t\treturn '';\n\t\t})()")(p)}finally{delete p.__$woCurrent}},this);g(s.childNodes,function(t,u){var y=d(t.nodeName);if(t.nodeType!==1||o.reservedPropertyNames.indexOf(y)!==-1){return}var A="string";for(var w=0,x=t.attributes.length;w<x;w++){if(t.attributes[w].nodeName==="constructor"&&t.attributes[w].nodeValue){A=d(t.attributes[w].nodeValue);break}}if(o.objectParser[l(A)]){var v=[];var z=z||new XMLSerializer();for(var w=0,x=t.childNodes.length;w<x;w++){if(t.childNodes[w].nodeType==3){v.push(t.childNodes[w].nodeValue)}else{v.push(z.serializeToString(t.childNodes[w]))}}var B=o.objectParser[l(A)](v.join(""));o.setObservable(this,y,B)}else{var B=m.utils.obj.createObject(A);if(B instanceof m.base.view){B.__woBag.createdByWipeout=true;B._initialize(t,p)}o.setObservable(this,y,B)}},this)};o.objectParser={json:function(p){return JSON.parse(p)},string:function(p){return p},bool:function(q){var p=l(q);return p?p!=="false"&&p!=="0":false},"int":function(p){return parseInt(k(p))},"float":function(p){return parseFloat(k(p))},regexp:function(p){return new RegExp(k(p))},date:function(p){return new Date(k(p))}};o.prototype._onModelChanged=function(r,q){if(r!==q){this.disposeOf(this.__woBag[n]);delete this.__woBag[n];if(q instanceof m.base.routedEventModel){var p=q.__triggerRoutedEventOnVM.register(this._onModelRoutedEvent,this);this.__woBag[n]=this.registerDisposable(p)}}this.onModelChanged(r,q)};o.prototype.onModelChanged=function(q,p){};o.prototype._onModelRoutedEvent=function(p){if(!(p.routedEvent instanceof m.base.routedEvent)){throw"Invaid routed event"}this.triggerRoutedEvent(p.routedEvent,p.eventArgs)};return o});e("wipeout.base.routedEvent",function(){var n=function n(){if(!(this instanceof n)){return new n()}};n.prototype.trigger=function(p,o){p.triggerRoutedEvent(this,new m.base.routedEventArgs(o,p))};n.prototype.unRegister=function(o,q,p){return q.unRegisterRoutedEvent(this,o,p)};n.prototype.register=function(o,q,p){return q.registerRoutedEvent(this,o,p)};return n});e("wipeout.base.routedEventArgs",function(){var n=function n(o,p){this.handled=false;this.data=o;this.originator=p};return n});e("wipeout.base.routedEventRegistration",function(){var n=function n(o){this.routedEvent=o;this.event=new m.base.event()};n.prototype.dispose=function(){this.event.dispose()};return n});e("wipeout.debug",function(){var n=function(){if(!window.jQuery){throw"This debug tool requires jQuery"}};return{renderedItems:function(q,p){var r=[],s;var o=function(t){if(t){switch(t.nodeType){case 1:g(t.childNodes,o);case 8:if((s=m.utils.html.getViewModel(t))&&r.indexOf(s)===-1&&(!p||s.constructor===p)){r.push(s)}}}};o(q||document.getElementsByTagName("body")[0]);return r}}});e("wipeout.settings",function(){function n(o){h(m.settings,function(p,q){delete m.settings[q]});h(o,function(q,p){m.settings[p]=q})}n.suppressWarnings=false;n.asynchronousTemplates=true;n.htmlAsyncTimeout=10000;return n});e("wipeout.base.contentControl",function(){var n=m.base.view.extend(function n(r,q){this._super(r||m.base.visual.getBlankTemplateId(),q);this.template=n.createTemplatePropertyFor(this.templateId,this)});n.createTemplatePropertyFor=function(s,r){var q=ko.dependentObservable({read:function(){var t=document.getElementById(s());return t?t.textContent:""},write:function(t){s(m.base.contentControl.createAnonymousTemplate(t))},owner:r});if(r instanceof m.base.visual){r.registerDisposable(q)}return q};var o="data-templatehash";var p=(function(){var q=(function(){var s=null;return function(){if(!s){s=m.utils.html.createElement("<div style='display: none'></div>");document.body.appendChild(s)}return s}})();var r=Math.floor(Math.random()*1000000000);return{create:function(y,s){var x=q();y=k(y||"");var t=n.hashCode(y).toString();if(!s){for(var v=0,w=x.childNodes.length;v<w;v++){if(x.childNodes[v].nodeType===1&&x.childNodes[v].nodeName==="SCRIPT"&&x.childNodes[v].id&&x.childNodes[v].attributes[o]&&x.childNodes[v].attributes[o].value===t&&m.utils.domData.get(x.childNodes[v],"rawTemplate")===y){return x.childNodes[v].id}}}var u="AnonymousTemplate"+(++r);n.createTemplate(u,y,t);return u},del:function(u){var t=q();for(var s=0;s<t.childNodes.length;s++){if(t.childNodes[s].nodeType===1&&t.childNodes[s].nodeName==="SCRIPT"&&t.childNodes[s].id===u){t.removeChild(t.childNodes[s]);s--}}},createTemplate:function(z,w,y){if(n.templateExists(z)){throw'Template: "'+z+'" already exists'}var x=q();var v=document.createElement("script");var s=document.createAttribute("type");s.value="text/xml";v.setAttributeNode(s);var t=document.createAttribute("id");t.value=z;v.setAttributeNode(t);y=y||n.hashCode(k(w)||"").toString();var u=document.createAttribute(o);u.value=y;v.setAttributeNode(u);v.textContent=w;x.appendChild(v);m.utils.domData.set(v,"rawTemplate",w)}}})();n.createAnonymousTemplate=p.create;n.deleteAnonymousTemplate=p.del;n.createTemplate=p.createTemplate;n.templateExists=function(q){return !!document.getElementById(q)};n.hashCode=function(u){var r=0;for(var s=0,t=u.length;s<t;s++){var q=u.charCodeAt(s);r=((r<<5)-r)+q;r=r&r}return r};return n});var m=m||{};m.base=m.base||{};e("wipeout.base.eventRegistration",function(){return m.base.disposable.extend(function n(o,p,q){this._super(q);this.callback=o;this.context=p})});e("wipeout.base.event",function(){var n=function n(){if(!(this instanceof n)){return new n()}this._registrations=[]};n.prototype.trigger=function(o){for(var p=0,q=this._registrations.length;p<q;p++){if(o instanceof m.base.routedEventArgs&&o.handled){return}this._registrations[p].callback.call(this._registrations[p].context,o)}};n.prototype.unRegister=function(o,p){p=p==null?window:p;for(var q=0;q<this._registrations.length;q++){if(this._registrations[q].callback===o&&this._registrations[q].context===p){this._registrations.splice(q,1);q--}}};n.prototype.dispose=function(){this._registrations.length=0};n.prototype.register=function(o,p,t){if(!(o instanceof Function)){throw"Invalid event callback"}if(t&&!(t instanceof Number)){throw"Invalid event priority"}var u=this._registrations;var q={priority:t||0,callback:o,context:p==null?window:p,dispose:function(){var v=u.indexOf(q);if(v>=0){u.splice(v,1)}}};for(var r=0,s=this._registrations.length;r<s;r++){if(q.priority<this._registrations[r].priority){this._registrations.splice(r,0,q);break}}if(r===s){this._registrations.push(q)}return new m.base.eventRegistration(q.callback,q.context,q.dispose,q.priority)};return n});e("wipeout.base.if",function(){var o=true;var p=function(){if(!o){return}o=false;n.blankTemplateId=m.base.contentControl.createAnonymousTemplate("",true)};var n=m.base.contentControl.extend(function n(u,t){p();this._super(u,t);this.shareParentScope=true;this.condition=ko.observable();this.elseTemplateId=ko.observable(n.blankTemplateId);var q=this.elseTemplateId.subscribe(this.elseTemplateChanged,this);this.registerDisposable(q);this.elseTemplate=m.base.contentControl.createTemplatePropertyFor(this.elseTemplateId,this);this.__cachedTemplateId=this.templateId();var r=this.condition.subscribe(this.onConditionChanged,this);this.registerDisposable(r);var s=this.templateId.subscribe(this.copyTemplateId,this);this.registerDisposable(s);this.copyTemplateId(this.templateId())});n.prototype.elseTemplateChanged=function(q){if(!this.condition()){this.templateId(q)}};n.prototype.onConditionChanged=function(q){if(this.__oldConditionVal&&!q){this.templateId(this.elseTemplateId())}else{if(!this.__oldConditionVal&&q){this.templateId(this.__cachedTemplateId)}}this.__oldConditionVal=!!q};n.prototype.copyTemplateId=function(q){if(q!==this.elseTemplateId()){this.__cachedTemplateId=q}if(!this.condition()&&q!==this.elseTemplateId()){this.templateId(this.elseTemplateId())}};return n});e("wipeout.base.itemsControl",function(){var n;var p=function(){if(n){return}n=m.base.contentControl.createAnonymousTemplate("<div data-bind='itemsControl: null'></div>")};var o=m.base.contentControl.extend(function o(u,s,t){p();this._super(u||n,t);this.itemTemplateId=ko.observable(s);this.itemTemplate=m.base.contentControl.createTemplatePropertyFor(this.itemTemplateId,this);this.itemSource=ko.observableArray([]);this.items=ko.observableArray([]);if(m.utils.ko.version()[0]<3){o._subscribeV2.call(this)}else{o._subscribeV3.call(this)}var q=this.items.subscribe(this._syncModelsAndViewModels,this);this.registerDisposable(q);s=this.itemTemplateId.peek();var r=this.itemTemplateId.subscribe(function(v){if(s!==v){try{this.reDrawItems()}finally{s=v}}},this);this.registerDisposable(r);this.registerRoutedEvent(o.removeItem,this._removeItem,this)});o._subscribeV2=function(){var t=this.itemSource.peek();var q=this.itemSource.subscribe(function(){try{if(this._modelsAndViewModelsAreSynched()){return}this._itemSourceChanged(ko.utils.compareArrays(t,arguments[0]||[]))}finally{t=m.utils.obj.copyArray(arguments[0]||[])}},this);this.registerDisposable(q);var s=this.items.peek();var r=this.items.subscribe(function(){try{this._itemsChanged(ko.utils.compareArrays(s,arguments[0]||[]))}finally{s=m.utils.obj.copyArray(arguments[0]||[])}},this);this.registerDisposable(r)};o.removeItem=m.base.routedEvent();o._subscribeV3=function(){var q=this.itemSource.subscribe(this._itemSourceChanged,this,"arrayChange");this.registerDisposable(q);var r=this.items.subscribe(this._itemsChanged,this,"arrayChange");this.registerDisposable(r)};o.prototype._removeItem=function(q){if(this.itemSource.indexOf(q.data)!==-1){this.removeItem(q.data);q.handled=true}};o.prototype.removeItem=function(q){this.itemSource.remove(q)};o.prototype._initialize=function(s,q){if(s){var r=s.getAttribute("shareParentScope")||s.getAttribute("share-parent-scope");if(r&&j(r)){throw"A wo.itemsControl cannot share it's parents scope."}}this._super(s,q)};o.prototype._syncModelsAndViewModels=function(){var q=false,t=false;var u=this.itemSource();if(u==null){t=true;u=[]}var v=this.items();if(u.length!==v.length){q=true;u.length=v.length}for(var r=0,s=v.length;r<s;r++){if(v[r].model()!==u[r]){u[r]=v[r].model();q=true}}if(q){if(t){this.itemSource(u)}else{this.itemSource.valueHasMutated()}}};o.prototype._modelsAndViewModelsAreSynched=function(){var s=this.itemSource()||[];var t=this.items()||[];if(s.length!==t.length){return false}for(var q=0,r=s.length;q<r;q++){if(s[q]!==t[q].model()){return false}}return true};o.prototype._itemsChanged=function(q){g(q,function(r){if(r.status===m.utils.ko.array.diff.deleted&&r.moved==null){this.onItemDeleted(r.value)}else{if(r.status===m.utils.ko.array.diff.added&&r.moved==null){this.onItemRendered(r.value)}}},this)};o.prototype._itemSourceChanged=function(r){var w=this.items();var s=[],q=[],x={},t=0;for(var u=0,v=r.length;u<v;u++){if(r[u].status===m.utils.ko.array.diff.retained){continue}else{if(r[u].status===m.utils.ko.array.diff.deleted){s.push((function(y){return function(){var z=w.splice(y.index+t,1)[0];if(y.moved!=null){x[y.moved+"."+y.index]=z}t--}})(r[u]))}else{if(r[u].status===m.utils.ko.array.diff.added){q.push((function(y){return function(){var z=y.moved!=null?x[y.index+"."+y.moved]:this._createItem(y.value);w.splice(y.index,0,z)}})(r[u]))}else{throw"Unsupported status"}}}}for(u=0,v=s.length;u<v;u++){s[u].call(this)}for(u=0,v=q.length;u<v;u++){q[u].call(this)}this.items.valueHasMutated()};o.prototype.onItemRendered=function(q){};o.prototype.dispose=function(){g(this.items(),function(q){q.dispose()});this._super()};o.prototype.onItemDeleted=function(q){q.dispose()};o.prototype._createItem=function(r){var q=this.createItem(r);q.__woBag.createdByWipeout=true;return q};o.prototype.createItem=function(q){return new m.base.view(this.itemTemplateId(),q)};o.prototype.reDrawItems=function(){var s=this.itemSource()||[];var t=this.items();t.length=s.length;for(var q=0,r=s.length;q<r;q++){t[q]=this._createItem(s[q])}this.items.valueHasMutated()};return o});e("wipeout.base.routedEventModel",function(){var n=m.base.object.extend(function n(){this.__triggerRoutedEventOnVM=new m.base.event();this.__routedEventSubscriptions=[]});n.prototype.triggerRoutedEvent=function(p,o){this.__triggerRoutedEventOnVM.trigger({routedEvent:p,eventArgs:o})};n.prototype.routedEventTriggered=function(r,o){for(var p=0,q=this.__routedEventSubscriptions.length;p<q;p++){if(o.handled){return}if(this.__routedEventSubscriptions[p].routedEvent===r){this.__routedEventSubscriptions[p].event.trigger(o)}}};n.prototype.registerRoutedEvent=function(u,o,p,s){var t;for(var q=0,r=this.__routedEventSubscriptions.length;q<r;q++){if(this.__routedEventSubscriptions[q].routedEvent===u){t=this.__routedEventSubscriptions[q];break}}if(!t){t=new m.base.routedEventRegistration(u);this.__routedEventSubscriptions.push(t)}return t.event.register(o,p,s)};n.prototype.unRegisterRoutedEvent=function(s,o,p){for(var q=0,r=this.__routedEventSubscriptions.length;q<r;q++){if(this.__routedEventSubscriptions[q].routedEvent===s){this.__routedEventSubscriptions[q].event.unRegister(o,p);return true}}return false};return n});e("wipeout.bindings.bindingBase",function(){var n=m.base.disposable.extend(function n(p){this._super();if(!p){throw"ArgumnetNullException"}this.bindingId=m.bindings.bindingBase.uniqueId();this.bindingMeta={};this.element=p;if(!this.getParentElement()){throw'Cannot apply a "wipeout.bindings.bindingBase" binding on an element without a parent node.'}var o=m.utils.domData.get(this.element,m.bindings.bindingBase.dataKey);if(!o){o=m.utils.domData.set(this.element,m.bindings.bindingBase.dataKey,[])}g(o,function(q){if(q.bindingMeta.controlsDescendantBindings){throw"There is already a binding on this element which controls children."}});o.push(this);m.bindings.bindingBase.registered[this.bindingId]=this;this.parentElement=this.getParentElement();this.moved(null,this.parentElement)});n.getParentElement=function(o){return o.parentElement||o.parentNode};n.prototype.getParentElement=function(){return n.getParentElement(this.element)};n.prototype.dispose=function(){this._super();this.moved(this.parentElement,null);var p;var o=m.utils.domData.get(this.element,m.bindings.bindingBase.dataKey);while((p=o.indexOf(this))!==-1){o.splice(p,1)}delete this.element;delete this.parentElement;delete m.bindings.bindingBase.registered[this.bindingId]};n.prototype.checkHasMoved=function(){return this.getParentElement()!==this.parentElement};n.prototype.hasMoved=function(){if(this.checkHasMoved()){this.moved(this.parentElement,this.getParentElement());this.parentElement=this.getParentElement()}};n.prototype.moved=function(p,o){};n.registered={};n.uniqueId=(function(){var o=Math.floor(Math.random()*1000000000);return function(){return"binding-"+(++o)}})();n.getBindings=function(q,p){if(p&&!(p instanceof Function)){throw"Invalid binding type"}var r=false;var o=[];g(m.utils.domData.get(q,m.bindings.bindingBase.dataKey),function(s){if(!p||s instanceof p){o.push(s);r|=s.bindingMeta.controlsDescendantBindings}});if(!r){m.utils.ko.enumerateOverChildren(q,function(s){g(m.bindings.bindingBase.getBindings(s,p),function(t){o.push(t)})})}return o};n.dataKey="wipeout.bindings.bindingBase";return n});c("itemsControl",true,function(){var o="";var p=null;var q=function(){if(p){return}var u="<!-- ko ic-render: null";if(f){u+=", wipeout-type: 'items[' + wipeout.utils.ko.peek($index) + ']'"}u+=" --><!-- /ko -->";if(p){return}p=m.base.contentControl.createAnonymousTemplate(u)};var r=function(v){var u=m.utils.ko.peek(v);if(u&&!(u instanceof m.base.itemsControl)){throw"This binding can only be used on an itemsControl"}};var n=function(w,x,u,y,v){r(y);q();return ko.bindingHandlers.template.init.call(this,w,t.createAccessor(y),u,y,v)};var s=function(w,x,u,y,v){r(y);return ko.bindingHandlers.template.update.call(this,w,t.createAccessor(y),u,y,v)};var t={createAccessor:function(u){u=m.utils.ko.peek(u);return function(){return{name:p,foreach:u.items,templateEngine:m.template.engine.instance}}}};return{init:n,update:s,utils:t}});c("ic-render",true,function(){return{init:function(q,r,n,s,p){var o=new m.bindings.render(q,p.$data,n,p.$parentContext.extend({$index:p.$index}));o.render(m.utils.ko.peek(p.$data))}}});c("render",true,function(){var n=m.bindings.bindingBase.extend(function n(q,s,o,p){this._super(q);this.bindingMeta=ko.bindingHandlers.template.init(this.element,m.bindings.render.createValueAccessor(s),o,null,p);this.allBindingsAccessor=o;this.bindingContext=p;if(ko.isObservable(s)){var r=s.peek();this.subscribed=s.subscribe(function(t){if(t===r){return}try{this.reRender(t)}finally{r=t}},this)}});n.prototype.moved=function(r,q){this._super(r,q);if(f&&!m.settings.suppressWarnings&&this.value){for(var o=0,p=this.value.__woBag.nodes.length;o<p;o++){if(m.utils.ko.parentElement(this.value.__woBag.nodes[o])!==this.value.__woBag.rootHtmlElement){console.warn("Only part of this view model was moved. Un moved nodes will be deleted or orphaned with their bindings cleared when this view model is re-rendered or disposed.");break}}}};n.prototype.dispose=function(){this.unRender();this._super();if(this.subscribed){this.subscribed.dispose();delete this.subscribed}};n.prototype.reRender=function(o){this.unRender();this.render(o)};n.prototype.unTemplate=function(){if(!this.value){return}h(this.value.templateItems,function(r,q){delete this.value.templateItems[q]},this);var p,o=ko.virtualElements.firstChild(this.element);while(o){p=o;o=ko.virtualElements.nextSibling(o);m.utils.html.cleanNode(p);m.bindings.bindingBase.getParentElement(p).removeChild(p)}this.value.__woBag.nodes.length=0};n.prototype.unRender=function(){if(!this.value){return}this.unTemplate();this.value.onUnrendered();if(this.value.__woBag.rootHtmlElement){m.utils.domData.set(this.value.__woBag.rootHtmlElement,m.bindings.wipeout.utils.wipeoutKey,undefined);delete this.value.__woBag.rootHtmlElement}if(this.templateChangedSubscription){this.value.disposeOf(this.templateChangedSubscription)}this.value.disposeOf(this.onDisposeEventSubscription);delete this.onDisposeEventSubscription;delete this.value;delete this.templateChangedSubscription};n.prototype.render=function(o){if(this.value||this.templateChangedSubscription){throw"This binding is already rendering a visual. Call unRender before rendering again."}if(!(this.value=o)){return}if(!(this.value instanceof m.base.visual)){throw"This binding can only be used to render a wo.visual within the context of a wo.visual"}if(this.value.__woBag.rootHtmlElement){throw"This visual has already been rendered. Call its unRender() function before rendering again."}m.utils.domData.set(this.element,m.bindings.wipeout.utils.wipeoutKey,this.value);this.value.__woBag.rootHtmlElement=this.element;var p=this.value.__woBag.disposed.register(this.unRender,this);this.onDisposeEventSubscription=this.value.registerDisposable(p);var q=this.value.templateId.subscribe(this.onTemplateChanged,this);this.templateChangedSubscription=this.value.registerDisposable(q);this.onTemplateChanged(this.value.templateId.peek())};n.prototype.onTemplateChanged=function(p){var o=this;function q(){if(o.value&&o.value.templateId.peek()!==p){return}o.doRendering()}this.unTemplate();if(p&&m.settings.asynchronousTemplates){ko.virtualElements.prepend(this.element,m.utils.html.createTemplatePlaceholder(this.value));m.template.asyncLoader.instance.load(p,q)}else{q()}};n.prototype.doRendering=function(){ko.bindingHandlers.template.update(this.element,m.bindings.render.createValueAccessor(this.value),this.allBindingsAccessor,null,this.bindingContext);var o=this.allBindingsAccessor();if(o["wipeout-type"]){m.bindings["wipeout-type"].utils.comment(this.element,o["wipeout-type"])}};n.init=function(r,s,o,t,q){var p=new m.bindings.render(r,s(),o,q);p.render(m.utils.ko.peek(s()));return p.bindingMeta};n.createValueAccessor=function(o){return function(){o=m.utils.ko.peek(o);if(!(o instanceof m.base.visual)){return{name:m.base.visual.getBlankTemplateId()}}var p={templateEngine:m.template.engine.instance,name:o.templateId.peek(),afterRender:function(r,q){var s=[];g(o.__woBag.nodes,function(t){s.push(t)});o.__woBag.nodes.length=0;g(r||[],function(t){o.__woBag.nodes.push(t)});o.onRendered(s,r)}};if(!o.shareParentScope){p.data=o}return p}};return n});c("wipeout-type",true,function(){var n="wipeout-type";return{init:function(){},utils:{comment:function(o,q){q=m.utils.ko.peek(q);if(o.nodeType===1){if(o.childNodes.length){o.insertBefore(document.createComment(q),o.childNodes[0])}else{o.appendChild(document.createComment(q))}}else{if(o.nodeType===8){var p;if(!(p=ko.utils.domData.get(o,n))){ko.utils.domData.set(o,n,p=o.textContent)}o.textContent=p+" wipeout-type: "+q}}}}}});c("wipeout",true,function(){var n=m.bindings.render.extend(function o(r,s,p,t,q){if(!(s instanceof Function)){throw"Invalid view type"}this.renderedView=new s();if(!(this.renderedView instanceof m.base.view)){throw"Invalid view type"}this._super(r,this.renderedView,p,q);if(this.renderedView.shareParentScope){throw"The root of an application cannot share its parents scope"}this.renderedView.model(t);this.render(this.renderedView);this.render=function(){throw"Cannont render this binding a second time, use the render binding instead"};this.renderedView.onApplicationInitialized()});n.prototype.dispose=function(){this._super();this.renderedView.dispose()};n.init=function(r,s,p,t,q){return new m.bindings.wipeout(r,s(),p,t,q).bindingMeta};n.utils={wipeoutKey:"__wipeout"};return n});c("wo",true,function(){var n=m.bindings.render.extend(function n(r,s,o,p){var t=n.create(s);this._super(r,t,o,p);t.__woBag.createdByWipeout=true;t._initialize(m.template.engine.xmlCache[s.initXml],p);if(s.id){var q=p;while(q.$data.shareParentScope){q=q.$parentContext}q.$data.templateItems[s.id]=t}this.render(t);this.render=function(){throw"Cannot render this binding a second time, use the render binding instead"}});n.prototype.dispose=function(){this.removeFromParentTemplateItems();var o=this.value;this._super();o.dispose()};n.prototype.removeFromParentTemplateItems=function(){if(this.parentElement&&this.value.id){m.bindings.wo.removeFromParentTemplateItems(this.parentElement,this.value.id)}};n.init=function(q,r,o,s,p){return new m.bindings.wo(q,r(),o,p).bindingMeta};n.removeFromParentTemplateItems=function(q,o){var p=m.utils.html.getViewModel(q);while(p&&p.shareParentScope){p=p.getParent()}if(p){return delete p.templateItems[o]}return false};n.create=function(o){if(!o.type){throw'Cannot create an instance of "'+o.name+'"'}return new o.type()};return n});e("wipeout.polyfills.Array",function(){var n=function(){};n.prototype.indexOf=function(q){for(var o=0,p=this.length;o<p;o++){if(this[o]===q){return o}}return -1};h(n.prototype,function(p,o){if(!Array.prototype[o]){Array.prototype[o]=p}});return n});e("wipeout.profile.highlightVM",function(){var n=m.base.object.extend(function n(p,o){this.vm=p;this.cssClass=o;this.nodes=p.entireViewModelHtml();m.utils.obj.enumerateArr(this.nodes,function(q){if(q.classList){q.classList.add(this.cssClass)}},this)});n.prototype.dispose=function(){m.utils.obj.enumerateArr(this.nodes,function(o){if(o.classList){o.classList.remove(this.cssClass)}},this)};return n});e("wipeout.profile.highlighter",function(){n.newId=(function(){var o=0;return function(){return ++o}})();n.generateColour=function(){var q=Math.floor((m.utils.obj.random(255)+255)/2);var p=Math.floor((m.utils.obj.random(255)+255)/2);var o=Math.floor((m.utils.obj.random(255)+255)/2);return q.toString(16)+p.toString(16)+o.toString(16)};function n(){this.style=document.createElement("style");this.index=0;this.styles=["wipeout-profiler-"+n.newId(),"wipeout-profiler-"+n.newId(),"wipeout-profiler-"+n.newId(),"wipeout-profiler-"+n.newId(),"wipeout-profiler-"+n.newId()];for(var p=0,q=this.styles.length;p<q;p++){this.style.innerHTML+=" ."+this.styles[p]+" {background-color:#"+n.generateColour()+" !important; cursor: pointer !important}"}document.head.appendChild(this.style);this.currentHighlighter={dispose:function(){}};var o=this;this.eventHandler=function(r){o.highlightVM(r)};window.addEventListener("mousemove",this.eventHandler,false)}n.prototype.nextStyle=function(){if(this.index>=this.styles.length-1){this.index=0}else{this.index++}return this.styles[this.index]};n.prototype.highlightVM=function(p){var q=document.elementFromPoint(p.clientX,p.clientY);if(q===this.currentElement){return}this.currentElement=q;var s=m.utils.html.getViewModel(this.currentElement);if(!s||s===this.currentHighlighter.vm){return}var r=this.__timeoutToken={};var o=this;setTimeout(function(){if(o.__timeoutToken!==r){return}o.currentHighlighter.dispose();o.currentHighlighter=new m.profile.highlightVM(s,o.nextStyle())},100)};n.prototype.dispose=function(){if(this.style.parentElement){this.style.parentElement.removeChild(this.style)}delete this.__timeoutToken;window.removeEventListener("mousemove",this.eventHandler);this.currentHighlighter.dispose()};return n});e("wipeout.profile.profile",function(){var p,n,t,s;var r=function r(v){if(arguments.length===0){v=true}if((v&&s)||(!v&&!s)){return}p=p||m.bindings.render.prototype.doRendering;n=n||m.base.view.prototype._initialize;t=t||m.template.engine.prototype.rewriteTemplate;if(v){s={highlighter:new m.profile.highlighter(),infoBox:m.utils.html.createElement('<div style="position: fixed; top: 10px; right: 10px; background-color: white; padding: 10px; border: 2px solid gray; display: none; max-height: 500px; overflow-y: scroll; z-index: 10000"></div>'),eventHandler:function(w){if(!w.ctrlKey){return}w.stopPropagation();w.preventDefault();var A=wo.html.getViewModel(w.target);if(!A){return}var B=A.getParents();B.splice(0,0,A);s.infoBox.innerHTML='<span style="float: right; margin-left: 10px; cursor: pointer;">x</span><br/>Open a console window and click on a class to debug it<br/>If view models do not have names, you can <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name">name them</a><br/>If view models have odd names ensure you are not using a minifier';s.infoBox.firstChild.addEventListener("click",function(){s.infoBox.style.display="none"});var x=[];for(var y=0,z=B.length;y<z;y++){s.infoBox.appendChild(o(B[y]).element)}s.infoBox.style.display="block"},dispose:function(){s.highlighter.dispose();if(s.infoBox.parentElement){s.infoBox.parentElement.removeChild(s.infoBox)}document.body.removeEventListener("click",s.eventHandler);m.bindings.render.prototype.doRendering=p;m.base.view.prototype._initialize=n;m.template.engine.prototype.rewriteTemplate=t}};m.bindings.render.prototype.doRendering=function(){var w=new Date();p.apply(this,arguments);var y=new Date()-w;if(!this.value.__woBag.profiler){this.value.__woBag.profiler={}}this.value.__woBag.profiler["Render time"]=y;var x=document.getElementById(this.value.templateId());if(x){this.value.__woBag.profiler["Template compile time"]=m.utils.domData.get(x,"rewriteTemplateTime")}};m.base.view.prototype._initialize=function(){var w=new Date();n.apply(this,arguments);var x=new Date()-w;if(!this.__woBag.profiler){this.__woBag.profiler={}}this.__woBag.profiler["Initialize time"]=x};m.template.engine.prototype.rewriteTemplate=function(z){var w=new Date();t.apply(this,arguments);var A=new Date()-w;var y=document.getElementById(z);if(y instanceof HTMLElement){var x=m.utils.domData.get(y,"rewriteTemplateTime");if(x instanceof Number){A+=x}m.utils.domData.set(y,"rewriteTemplateTime",A)}};document.body.appendChild(s.infoBox);document.body.addEventListener("click",s.eventHandler,false)}else{s.dispose();s=null}return};var u=new Function("viewModel","model","//Use your browser's debugger to inspect the model and view model\ndebugger;");var q=/^function\s*([^\s(]+)/;var o=function(B){var v=document.createElement("div");m.utils.domData.set(v,m.bindings.wipeout.utils.wipeoutKey,B);var A;var w=B.constructor.name?B.constructor.name:((A=B.constructor.toString().match(q))?A[1]:"unknown vm type");var y=["<h4 style='cursor: pointer; margin-bottom: 5px;'>"+w+(B.id?(" #"+B.id):"")+"</h4>"];if(B.__woBag.profiler){for(var x in B.__woBag.profiler){y.push("<label>"+x+":</label> "+B.__woBag.profiler[x])}}v.innerHTML+=y.join("<br />");function z(){u(B,B.model())}v.firstChild.addEventListener("click",z,false);return{element:v,dispsoe:function(){v.firstChild.removeEventListener("click",z);m.utils.domData.clear(v)}}};return r});e("wipeout.template.asyncLoader",function(){var n=function n(){this.pending={}};n.prototype.load=function(q,p){if(!this.pending[q]){this.pending[q]=new o(q)}this.pending[q].add(p||function(){})};function o(q){this._success=m.base.contentControl.templateExists(q);this._callbacks=this._success?null:[];this.templateName=q;if(!this._success){var p=this;m.utils.obj.ajax({type:"GET",url:q,success:function(u){m.base.contentControl.createTemplate(q,u.responseText);p._success=true;var r=p._callbacks;delete p._callbacks;for(var s=0,t=r.length;s<t;s++){r[s]()}},error:function(){delete p._callbacks;p._success=false;throw'Could not locate template "'+q+'"'}})}}o.prototype.add=function(p){if(this._callbacks){this._callbacks.push(p)}else{if(this._success){p()}else{throw'Could not load template "'+this.templateName+'"'}}};n.instance=new n();return n});e("wipeout.template.engine",function(){var q=function q(){};q.prototype=new ko.templateEngine();var o=/\$find/;var n=/\$call/;var p=/\$findAndCall/;q.createJavaScriptEvaluatorFunction=function(v){var t=o.test(v)?"\n\tvar $find = wipeout.utils.find.create(bindingContext);":"";var u=p.test(v)?"\n\tvar $findAndCall = wipeout.utils.findAndCall.create($find);":"";var s=n.test(v)?"\n\tvar $call = wipeout.utils.call.create();":"";return new Function("bindingContext","with(bindingContext) {"+t+u+s+"\n\twith($data) {\n\t\treturn "+v+";\n\t}\n}")};q.createJavaScriptEvaluatorBlock=function(s){var t=q.newScriptId();if(s instanceof Function){q.scriptCache[t]=s}else{q.scriptCache[t]=q.createJavaScriptEvaluatorFunction(s)}return q.openCodeTag+t+q.closeCodeTag};q.prototype.createJavaScriptEvaluatorBlock=function(s){return q.createJavaScriptEvaluatorBlock(s)};q.prototype.rewriteTemplate=function(u,s,v){var t=document.getElementById(u);if(t instanceof HTMLElement){if(!q.scriptHasBeenReWritten.test(t.textContent)){ko.templateEngine.prototype.rewriteTemplate.call(this,u,s,v)}else{this.makeTemplateSource(u,v).data("isRewritten",true)}this.wipeoutRewrite(t,s)}else{ko.templateEngine.prototype.rewriteTemplate.call(this,u,s,v)}};q.wipeoutRewrite=function(z,x){if(m.base.visual.reservedTags[z.nodeName]){for(var s=0;s<z.childNodes.length;s++){if(z.childNodes[s].nodeType===1){q.wipeoutRewrite(z.childNodes[s],x)}}}else{var u=q.newScriptId();q.xmlCache[u]=z;var y="<!-- ko";if(f){y+=" wipeout-type: '"+z.nodeName+"',"}var t=q.getId(z);if(t){t="'"+t+"'"}y+=" wo: { type: "+d(z.nodeName)+", id: "+t+", name: '"+z.nodeName+"', initXml: '"+u+"'} --><!-- /ko -->";var w=m.utils.html.parseXml("<root>"+x(y)+"</root>");while(w.childNodes.length){var v=w.childNodes[0];v.parentNode.removeChild(v);z.parentNode.insertBefore(v,z)}z.parentNode.removeChild(z)}};q.getId=function(u){for(var s=0,t=u.attributes.length;s<t;s++){if(u.attributes[s].nodeName==="id"){return u.attributes[s].value}}return null};q.prototype.wipeoutRewrite=function(u,t){var w=new XMLSerializer();var x=m.utils.html.parseXml("<root>"+u.textContent+"</root>");var v=[];for(var s=0;s<x.childNodes.length;s++){if(x.childNodes[s].nodeType===1){q.wipeoutRewrite(x.childNodes[s],t)}v.push(w.serializeToString(x.childNodes[s]))}u.textContent=v.join("")};q.prototype.renderTemplateSource=function(w,s,u){if(!(s.$data instanceof m.base.view)){return[]}var t=w.data("precompiled");if(!t){t=new m.template.htmlBuilder(w.text());w.data("precompiled",t)}var v;ko.dependentObservable(function(){v=t.render(s)},this).dispose();return v};if(f){var r=function(s){q.prototype[s]=function(){ko.templateEngine.prototype[s].apply(this,arguments)}};r("isTemplateRewritten");r("makeTemplateSource");r("renderTemplate")}q.newScriptId=(function(){var s=Math.floor(Math.random()*10000);return function(){return(++s).toString()}})();q.xmlCache={};q.scriptCache={};q.openCodeTag="<!-- wipeout_code: {";q.closeCodeTag="} -->";q.scriptHasBeenReWritten=RegExp(q.openCodeTag.replace("{","{")+"[0-9]+"+q.closeCodeTag.replace("}","}"));q.instance=new q();return q});e("wipeout.template.htmlBuilder",function(){var n=function n(o){this.preRendered=[];this.generatePreRender(o)};n.prototype.render=function(o){var p=[];var u=[];for(var r=0,s=this.preRendered.length;r<s;r++){if(this.preRendered[r] instanceof Function){var t=this.preRendered[r](o);u.push(t)}else{u.push(this.preRendered[r])}}var q=m.utils.html.createElements(u.join(""));h(n.getTemplateIds({childNodes:q}),function(w,v){o.$data.templateItems[v]=w});if(o.$data instanceof m.base.view){o.$data.onInitialized()}return q};n.prototype.generatePreRender=function(t){var u=m.utils.html.parseXml("<root>"+t+"</root>");var s=m.template.htmlBuilder.generateTemplate(u);var q=m.template.engine.openCodeTag;var o=m.template.engine.closeCodeTag;this.preRendered.length=0;var r,p;while((r=s.indexOf(q))!==-1){this.preRendered.push(s.substr(0,r));s=s.substr(r);p=s.indexOf(o);if(p===-1){throw"Invalid wipeout_code tag."}this.preRendered.push((function(v){return m.template.engine.scriptCache[v]})(s.substr(q.length,p-q.length)));s=s.substr(p+o.length)}this.preRendered.push(s)};n.getTemplateIds=function(o){var p={};g(o.childNodes,function(s){if(s.nodeType===1){for(var q=0,r=s.attributes.length;q<r;q++){if(s.attributes[q].nodeName==="id"){p[s.attributes[q].nodeValue]=s;break}}h(n.getTemplateIds(s),function(t,u){p[u]=t})}});return p};n.generateTemplate=function(q){var o=[];var p=new XMLSerializer();g(q.childNodes,function(s){if(s.nodeType==1){var r=m.utils.html.parseXml(p.serializeToString(s));while(r.childNodes.length){r.removeChild(r.childNodes[0])}var t=m.utils.html.createElement(p.serializeToString(r));t.innerHTML=m.template.htmlBuilder.generateTemplate(s);o.push(m.utils.html.outerHTML(t))}else{if(s.nodeType===3){o.push(s.data)}else{o.push(p.serializeToString(s))}}});return o.join("")};return n});e("wipeout.utils.bindingDomManipulationWorker",function(){var n=m.utils.domManipulationWorkerBase.extend(function n(){this._super()});n.prototype.finish=function(){h(m.bindings.bindingBase.registered,function(o){if(o.checkHasMoved()&&this._mutations.indexOf(o.element)===-1){this._mutations.push(o.element)}},this);this._super()};return n});e("wipeout.utils.call",function(){var n=m.base.object.extend(function n(){this._super()});n.prototype.call=function(r){if(!r){throw"Could not find an object to call function on."}var p=[];var o=null;var q=function(){var t=r;var u=null;if(p.length>0){for(var v=0,w=p.length-1;v<w&&t;v++){t=ko.utils.unwrapObservable(t[p[v]])}if(!t){var x="Could not find the object "+p[v-1]}if(!t[p[v]]){throw'Could not find function :"'+p[v]+'" on this object.'}u=t[p[v]]}else{if(r.constructor!==Function){throw"Cannot call an object like a function"}u=r}if(o){var s=m.utils.obj.copyArray(o);g(arguments,function(y){s.push(y)});return u.apply(t,s)}else{return u.apply(t,arguments)}};q.dot=function(s){p.push(s);return q};q.args=function(){o=m.utils.obj.copyArray(arguments);return q};return q};n.create=function(){var o=new m.utils.call();return function(p){return o.call(p)}};return n});e("wipeout.utils.domData",function(){var o="__wipeout_domData";function n(){}function p(q){if(!q){throw"Invalid html element"}return q[o]=q[o]||{}}n.get=function(q,r){return arguments.length>1?p(q)[r]:p(q)};n.set=function(q,r,s){return p(q)[r]=s};n.clear=function(q,r){if(r){delete p(q)[r]}else{delete q[o]}};return n});e("wipeout.utils.find",function(){var n=m.base.object.extend(function n(o){this._super();this.bindingContext=o});n.prototype.find=function(r,o){var s={};if(o){for(var q in o){s[q]=o[q]}}o=s;if(!o.$number){o.$number=0}if(r&&r.constructor===Function){o.$instanceOf=r}else{if(r&&r.constructor!==String){for(var q in r){o[q]=r[q]}}else{o.$ancestry=m.utils.obj.trim(r)}}if(!o.$number&&o.$n){o.$number=o.$n}if(!o.$instanceOf&&o.$i){o.$instanceOf=o.$i}if(!o.$instanceOf&&o.$instanceof){o.$instanceOf=o.$instanceof}if(!o.$ancestry&&o.$a){o.$ancestry=o.$a}if(!o.$type&&o.$t){o.$type=o.$t}var p=o.$m||o.$model;delete o.$m;delete o.$model;delete o.$n;delete o.$instanceof;delete o.$i;delete o.$a;delete o.$t;return this._find(o,p)};n.prototype._find=function(q,s){if(!this.bindingContext||!this.bindingContext.$parentContext){return null}var r=s?function(v){return v&&v.$data instanceof wo.view?v.$data.model():null}:function(v){return v?v.$data:null};var p,o=this.bindingContext;for(var u=q.$number;u>=0&&o;u--){var t=0;o=o.$parentContext;while(!m.utils.find.is(p=r(o),q,t)&&o){o=o.$parentContext;t++}}return p};n.create=function(o){var p=new m.utils.find(o);return function(r,q){return p.find(r,q)}};n.regex={ancestors:/^(great)*(grand){0,1}parent$/,great:/great/g,grand:/grand/g};n.$type=function(o,q,p){return o&&o.constructor===q};n.$ancestry=function(o,r,q){r=(r||"").toLowerCase();if(r.indexOf("greatparent")!==-1){return false}var s=0;var p=r.match(m.utils.find.regex.great);if(p){s+=p.length}p=r.match(m.utils.find.regex.grand);if(p){s+=p.length}return s===q};n.$instanceOf=function(o,q,p){if(!o||!q||q.constructor!==Function){return false}return o instanceof q};n.is=function(r,o,q){if(!r){return false}for(var p in o){if(p==="$number"){continue}if(p[0]==="$"){if(!m.utils.find[p](r,o[p],q)){return false}}else{if(ko.utils.unwrapObservable(o[p])!==ko.utils.unwrapObservable(r[p])){return false}}}return true};return n});e("wipeout.utils.findAndCall",function(){var o=m.utils.call.extend(function n(p){this._super();this.find=p});o.prototype.call=function(q,p){return this._super(this.find(q,p))};o.create=function(q){var p=new m.utils.findAndCall(q);return function(s,r){return p.call(s,r)}};return o});e("wipeout.utils.html",function(){var B=function(J){if(!J){return null}if(J.constructor===HTMLHtmlElement){throw"Cannot serialize a Html element using outerHTML"}var K=J.nodeType===1?(F[J.tagName.toLowerCase()]||"div"):"div";var I=document.createElement(K);I.appendChild(J.cloneNode(true));return I.innerHTML};var H=/[a-zA-Z0-9]/;var w=function(K){K=K.replace(/^\s+|\s+$/g,"");if(!K||K[0]!=="<"){throw"Invalid html tag"}K=K.substring(1).replace(/^\s+|\s+$/g,"");for(var I=0,J=K.length;I<J;I++){if(!H.test(K[I])){break}}return K.substring(0,I)};var G=/<\!--[^>]*-->/g;var v=function(I){I=I.replace(G,"").replace(/^\s+|\s+$/g,"");var J=0;if((J=I.indexOf("<"))===-1){return null}return w(I.substring(J))};var F={area:"map",base:"head",basefont:"head",body:"html",caption:"table",col:"colgroup",colgroup:"table",command:"menu",frame:"frameset",frameset:"html",head:"html",keygen:"form",li:"ul",optgroup:"select",option:"select",rp:"rt",rt:"ruby",source:"audio",tbody:"table",td:"tr",tfoot:"table",th:"tr",thead:"table",tr:"tbody"};var n={html:true,basefont:true,base:true,body:true,frame:true,frameset:true,head:true};function t(M,J){for(var K=0,L=M.childNodes.length;K<L;K++){var I=M.childNodes[K];if(I.nodeType===1&&m.utils.obj.trimToLower(I.tagName)===m.utils.obj.trimToLower(J)){return I}}}var z={audio:true,col:true,colgroup:true,frameset:true,head:true,rp:true,rt:true,ruby:true,select:true,style:true,table:true,tbody:true,tfooy:true,thead:true,title:true,tr:true};var E={keygen:"select"};var p=function(J){var M=m.utils.obj.trimToLower(w(J));if(n[M]){throw'Cannot create an instance of the "'+M+'" tag.'}var L=F[M]||"div";if(ko.utils.ieVersion&&z[L]){return t(p("<"+L+">"+J+"</"+L+">"),M)}var K=document.createElement(L);K.innerHTML=J;function I(Q){if(!Q){return null}for(var O=0,P=K.childNodes.length;O<P;O++){if(K.childNodes[O].nodeType===1&&K.childNodes[O].tagName.toLowerCase()===Q){var N=K.childNodes[O];K.removeChild(N);return N}}return null}return I(M)||I(E[M])};var q=function(J){if(J==null){return[]}var M=v(J)||"div";var L=F[w("<"+M+"/>")]||"div";if(ko.utils.ieVersion&&z[L]){var I=p("<"+L+">"+J+"</"+L+">");var K=[];while(I.firstChild){K.push(I.firstChild);I.removeChild(I.firstChild)}return K}J="<"+M+"></"+M+">"+J+"<"+M+"></"+M+">";var I=document.createElement(L);I.innerHTML=J;var K=[];while(I.firstChild){K.push(I.firstChild);I.removeChild(I.firstChild)}K.splice(0,1);K.splice(K.length-1,1);return K};var u=function(K){var I=[];if(m.utils.ko.isVirtual(K)){var O=m.utils.ko.parentElement(K);for(var L=0,M=O.childNodes.length;L<M;L++){if(O.childNodes[L]===K){break}}L++;for(var M=O.childNodes.length;L<M;L++){I.push(O.childNodes[L])}}else{I=K.childNodes}var N=[];var J=0;for(var L=0,M=I.length;L<M;L++){if(m.utils.ko.isVirtualClosing(I[L])){J--;if(J<0){return N}continue}if(J>0){continue}N.push(I[L]);if(m.utils.ko.isVirtual(I[L])){J++}}return N};var x=function(I){var K=m.utils.domData.get(I,m.bindings.wipeout.utils.wipeoutKey);if(K){return K}var J=m.utils.ko.parentElement(I);if(J){return x(J)}return null};var r=function(I){return p("<span>Loading template</span>")};var A=function(I){m.template.asyncLoader.instance.load(I)};var o=function(L){var I=m.utils.domData.get(L,m.bindings.bindingBase.dataKey);var K=false;g(I,function(M){K|=M.bindingMeta.controlsDescendantBindings});if(!K){var J=ko.virtualElements.firstChild(L);while(J){o(J);J=ko.virtualElements.nextSibling(J)}}g(I,function(M){M.dispose()});m.utils.domData.clear(L,m.bindings.bindingBase.dataKey);ko.cleanNode(L)};var y=function y(I){m.utils.htmlAsync(function(J){I();J()})};try{var C=new DOMParser().parseFromString("<","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(s){}var D=function(I){var J=new DOMParser().parseFromString(I,"application/xml");if(J.getElementsByTagNameNS(C,"parsererror").length){throw"Invalid xml template:\n"+new XMLSerializer().serializeToString(J.firstChild)}return J.documentElement};y.parseXml=D;y.cleanNode=o;y.cannotCreateTags=n;y.createTemplatePlaceholder=r;y.specialTags=F;y.getFirstTagName=v;y.getTagName=w;y.getAllChildren=u;y.outerHTML=B;y.createElement=p;y.createElements=q;y.getViewModel=x;return y});e("wipeout.utils.htmlAsync",function(){var n=(function(){var p=[];var r=[];var t=null;function s(){if(t||!p.length){return}t=window.MutationObserver?new m.utils.mutationObserverDomManipulationWorker():new m.utils.bindingDomManipulationWorker();var u=function(){if(u===null){return}u=null;setTimeout(function(){q()},1)};p.splice(0,1)[0](u);setTimeout(function(){if(!u){return}if(!m.settings.suppressWarnings){console.error("Cleanup callback for async move method was not called. Cleanup has been automatically called, which may cause undesired behaviour.")}u()},m.settings.htmlAsyncTimeout>0?m.settings.htmlAsyncTimeout:10000)}function q(){t.finish();t=null;s()}return{add:function(u){p.push(u);s()}}}());var o=function o(p){if(!(p instanceof Function)){throw"Invalid move functionality"}n.add(p)};return o});e("wipeout.utils.ko",function(){var n=function n(){};n.version=function(){if(!ko||!ko.version){return null}var t=ko.version.split(".");for(var r=0,s=t.length;r<s;r++){t[r]=parseInt(t[r])}return t};n.peek=function(r){if(ko.isObservable(r)){return r.peek()}else{return r}};n.array={diff:{added:"added",deleted:"deleted",retained:"retained"}};n.parentElement=function(t){var s=0;var r=t.previousSibling;while(r){if(n.isVirtual(r)){if(s<0){s++}else{return r}}else{if(n.isVirtualClosing(r)){s--}}r=r.previousSibling}return t.parentNode};var o=document&&document.createComment("test").text==="<!--test-->";var q=o?/^<!--\s*ko(?:\s+(.+\s*\:[\s\S]*))?\s*-->$/:/^\s*ko(?:\s+(.+\s*\:[\s\S]*))?\s*$/;var p=o?/^<!--\s*\/ko\s*-->$/:/^\s*\/ko\s*$/;n.isVirtual=function(r){return r&&(r.nodeType==8)&&(o?r.text:r.nodeValue).match(q)};n.isVirtualClosing=function(r){return r&&(r.nodeType==8)&&(o?r.text:r.nodeValue).match(p)};n.getClosingTag=function(s){if(!n.isVirtual(s)){throw"Invalid virtual element"}var r=1;while(s&&r>0){s=s.nextSibling;if(n.isVirtual(s)){r++}if(n.isVirtualClosing(s)){r--}}if(!s){throw"Could not find closing tag for element."}return s};n.enumerateOverChildren=function(s,r){s=ko.virtualElements.firstChild(s);while(s){r(s);s=ko.virtualElements.nextSibling(s)}};return n});e("wipeout.utils.mutationObserverDomManipulationWorker",function(){var n=m.utils.domManipulationWorkerBase.extend(function n(){this._super();var o=this;this._observer=new MutationObserver(function(p){o.appendRemovedNodes(p)});this._observer.observe(document.body,{childList:true,subtree:true})});n.prototype.appendRemovedNodes=function(o){g(o,function(p){g(p.removedNodes,function(q){if(this._mutations.indexOf(q)===-1){this._mutations.push(q)}},this)},this)};n.prototype.finish=function(){this._observer.disconnect();delete this._observer;this._super()};return n});window.wipeout=m;window.wo={};h(m.base,function(o,n){window.wo[n]=o});h(m.utils,function(o,n){window.wo[n]=o});var f=wo.DEBUG=false})();